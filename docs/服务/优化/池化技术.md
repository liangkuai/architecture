# 优化

### 池化技术

在并发环境下，系统不能确定在任意时刻中，有多少任务需要执行，有多少资源需要投入。这种不确定性将带来以下若干问题：

- 频繁申请/销毁资源和调度资源，将带来额外的消耗，可能会非常巨大。
- 对资源无限申请缺少抑制手段，易引发系统资源耗尽的风险。
- 系统无法合理管理内部的资源，会降低系统的稳定性。

**而池化技术解决的核心问题就是资源管理问题。**

#### 1. 线程池
线程过多会带来额外的开销，其中包括创建销毁线程的开销、调度线程的开销等等，同时也降低了计算机的整体性能。在这种场景下，我们通常会提前创建若干个线程，通过线程池来进行管理。一方面避免了处理任务时创建销毁线程开销的代价，另一方面避免了线程数量膨胀导致的过分调度问题，保证了对内核的充分利用。

#### 2. 连接池
预先申请数据库连接，提升申请连接的速度，降低系统的开销。

一次 SQL 查询大概会经过这些步骤：
1. 和 MySQL Server 建立 TCP 连接；
2. MySQL 权限认证；
3. Client 发送 SQL 语句
4. Server 返回语句执行结果
5. 关闭 TCP 连接。

如果不使用连接池的话，执行一条 SQL，会花不少时间在连接、安全认证上。

#### 3. 内存池
预先申请内存，提升申请内存速度，减少内存碎片。

#### 4. 实例池
循环使用对象，减少资源在初始化和释放时的昂贵损耗。




### 参考
- [ava线程池实现原理及其在美团业务中的实践](https://tech.meituan.com/2020/04/02/java-pooling-pratice-in-meituan.html)