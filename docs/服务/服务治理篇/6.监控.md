# 6. 监控

在高并发、分布式的场景下，故障经常是突然间就雪崩式爆发。所以必须建立完善的监控体系，尽可能发现故障的征兆。

微服务架构中组件繁多，各个组件所需要监控的指标不同。比如 Redis 缓存一般监控占用内存值、网络流量，数据库监控连接数、磁盘空间，业务服务监控并发数、响应延迟、错误率等。

一般的做法是，
1. 让各个组件提供报告自己当前状态的接口（metrics 接口），这个接口输出的数据格式应该是一致的；
2. 然后部署一个指标采集器组件，定时从这些接口获取并保持组件状态，同时提供查询服务；
3. 最后还需要一个 UI，从指标采集器查询各项指标，绘制监控界面或者根据阈值发出告警。

大部分组件都不需要自己动手开发，网络上有开源组件。比如 RedisExporter 和 MySQLExporter，这两个组件分别提供了 Redis 缓存和 MySQL 数据库的指标接口。微服务则根据各个服务的业务逻辑实现自定义的指标接口。然后采用 Prometheus 作为指标采集器，Grafana 配置监控界面和邮件告警。



### 参考
- [一文详解微服务架构 - 古霜卡比](https://www.cnblogs.com/skabyy/p/11396571.html)